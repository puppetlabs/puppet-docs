<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>
  Class: Puppet::Pops::Binder::Producers::ArrayMultibindProducer
  
    &mdash; Documentation by YARD 0.8.7.6
  
</title>

  <link rel="stylesheet" href="../../../../css/style.css" type="text/css" charset="utf-8" />

  <link rel="stylesheet" href="../../../../css/common.css" type="text/css" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  hasFrames = window.top.frames.main ? true : false;
  relpath = '../../../../';
  framesUrl = "../../../../frames.html#!Puppet/Pops/Binder/Producers/ArrayMultibindProducer.html";
</script>


  <script type="text/javascript" charset="utf-8" src="../../../../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../../../../js/app.js"></script>


  </head>
  <body>
    <div id="header">
      <div id="menu">
  
    <a href="../../../../_index.html">Index (A)</a> &raquo;
    <span class='title'><span class='object_link'><a href="../../../../Puppet.html" title="Puppet (module)">Puppet</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../../../Pops.html" title="Puppet::Pops (module)">Pops</a></span></span> &raquo; <span class='title'><span class='object_link'>Binder</span></span> &raquo; <span class='title'><span class='object_link'><a href="../Producers.html" title="Puppet::Pops::Binder::Producers (module)">Producers</a></span></span>
     &raquo; 
    <span class="title">ArrayMultibindProducer</span>
  

  <div class="noframes"><span class="title">(</span><a href="." target="_top">no frames</a><span class="title">)</span></div>
</div>

      <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="../../../../class_list.html">
      Class List
    </a>
  
    <a class="full_list_link" id="method_list_link"
        href="../../../../method_list.html">
      Method List
    </a>
  
    <a class="full_list_link" id="file_list_link"
        href="../../../../file_list.html">
      File List
    </a>
  
</div>
      <div class="clear"></div>
    </div>

    <iframe id="search_frame"></iframe>

    <div id="content"><h1>Class: Puppet::Pops::Binder::Producers::ArrayMultibindProducer
  
  
  
</h1>

<dl class="box">
  
    <dt class="r1">Inherits:</dt>
    <dd class="r1">
      <span class="inheritName"><span class='object_link'><a href="MultibindProducer.html" title="Puppet::Pops::Binder::Producers::MultibindProducer (class)">MultibindProducer</a></span></span>
      
        <ul class="fullTree">
          <li><span class='object_link'>Object</span></li>
          
            <li class="next"><span class='object_link'><a href="Producer.html" title="Puppet::Pops::Binder::Producers::Producer (class)">Producer</a></span></li>
          
            <li class="next"><span class='object_link'><a href="AbstractArgumentedProducer.html" title="Puppet::Pops::Binder::Producers::AbstractArgumentedProducer (class)">AbstractArgumentedProducer</a></span></li>
          
            <li class="next"><span class='object_link'><a href="MultibindProducer.html" title="Puppet::Pops::Binder::Producers::MultibindProducer (class)">MultibindProducer</a></span></li>
          
            <li class="next">Puppet::Pops::Binder::Producers::ArrayMultibindProducer</li>
          
        </ul>
        <a href="#" class="inheritanceTree">show all</a>
      
      </dd>
    
  
  
    
  
    
  
  
  
    <dt class="r2 last">Defined in:</dt>
    <dd class="r2 last">lib/puppet/pops/binder/producers.rb</dd>
  
</dl>
<div class="clear"></div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    
  <div class="note notetag">
    <strong>Note:</strong>
    <div class='inline'><p>Collection accepts elements that comply with the array&#39;s element type, or the entire type (i.e. Array[element_type]).
If the type is restrictive - e.g. Array[String] and an Array[String] is contributed, the result will not be type
compliant without also using the <code>:flatten</code> option, and a type error will be raised. For an array with relaxed typing
i.e. Array[Data], it is valid to produce a result such as <code>[&#39;a&#39;, [&#39;b&#39;, &#39;c&#39;], &#39;d&#39;]</code> and no flattening is required
and no error is raised (but using the array needs to be aware of potential array, non-array entries.
The use of the option <code>:flatten</code> controls how the result is flattened.</p>
</div>
  </div>

<p>A configurable multibind producer for Array type multibindings.</p>

<p>This implementation collects all contributions to the multibind and then combines them using the following rules:</p>

<ul>
<li>all <em>unnamed</em> entries are added unless the option <code>:priority_on_unnamed</code> is set to true, in which case the unnamed
contribution with the highest priority is added, and the rest are ignored (unless they have the same priority in which
case an error is raised).</li>
<li>all <em>named</em> entries are handled the same way as <em>unnamed</em> but the option <code>:priority_on_named</code> controls their handling.</li>
<li>the option <code>:uniq</code> post processes the result to only contain unique entries</li>
<li>the option <code>:flatten</code> post processes the result by flattening all nested arrays.</li>
<li>If both <code>:flatten</code> and <code>:uniq</code> are true, flattening is done first.</li>
</ul>


  </div>
</div>
<div class="tags">
  

</div>



  <h2>Instance Attribute Summary <small>(<a href="#" class="summary_toggle">collapse</a>)</small></h2>
  <ul class="summary">
    
      
<li class="public ">
  <span class="summary_signature">
    
      <a href="#flatten-instance_method" title="#flatten (instance method)">- (Boolean, Integer) <strong>flatten</strong> </a>
    

    
  </span>
  
  
  
  
    
      <span class="note title readonly">readonly</span>
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>If result should be flattened (true), or not (false), or flattened to given level (0 = none, -1 = all).</p>
</div></span>
  
</li>

    
      
<li class="public ">
  <span class="summary_signature">
    
      <a href="#priority_on_named-instance_method" title="#priority_on_named (instance method)">- (Boolean) <strong>priority_on_named</strong> </a>
    

    
  </span>
  
  
  
  
    
      <span class="note title readonly">readonly</span>
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Whether priority should be considered for named contributions.</p>
</div></span>
  
</li>

    
      
<li class="public ">
  <span class="summary_signature">
    
      <a href="#priority_on_unnamed-instance_method" title="#priority_on_unnamed (instance method)">- (Boolean) <strong>priority_on_unnamed</strong> </a>
    

    
  </span>
  
  
  
  
    
      <span class="note title readonly">readonly</span>
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Whether priority should be considered for unnamed contributions.</p>
</div></span>
  
</li>

    
      
<li class="public ">
  <span class="summary_signature">
    
      <a href="#uniq-instance_method" title="#uniq (instance method)">- (Boolean) <strong>uniq</strong> </a>
    

    
  </span>
  
  
  
  
    
      <span class="note title readonly">readonly</span>
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Whether the result should be made contain unique (non-equal) entries or not.</p>
</div></span>
  
</li>

    
  </ul>



  
  
  <h3 class="inherited">Attributes inherited from <span class='object_link'><a href="AbstractArgumentedProducer.html" title="Puppet::Pops::Binder::Producers::AbstractArgumentedProducer (class)">AbstractArgumentedProducer</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="AbstractArgumentedProducer.html#binding-instance_method" title="Puppet::Pops::Binder::Producers::AbstractArgumentedProducer#binding (method)">#binding</a></span>, <span class='object_link'><a href="AbstractArgumentedProducer.html#injector-instance_method" title="Puppet::Pops::Binder::Producers::AbstractArgumentedProducer#injector (method)">#injector</a></span></p>

  
  
  <h3 class="inherited">Attributes inherited from <span class='object_link'><a href="Producer.html" title="Puppet::Pops::Binder::Producers::Producer (class)">Producer</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="Producer.html#transformer-instance_method" title="Puppet::Pops::Binder::Producers::Producer#transformer (method)">#transformer</a></span></p>


  
    <h2>
      Instance Method Summary
      <small>(<a href="#" class="summary_toggle">collapse</a>)</small>
    </h2>

    <ul class="summary">
      
        
<li class="protected ">
  <span class="summary_signature">
    
      <a href="#assert_type-instance_method" title="#assert_type (instance method)">- (Object) <strong>assert_type</strong>(binding, tc, value) </a>
    

    
  </span>
  
  
  
  
  <span class="note title protected">protected</span>
  
  
  <span class="private note title">private</span>

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        
<li class="public ">
  <span class="summary_signature">
    
      <a href="#initialize-instance_method" title="#initialize (instance method)">- (ArrayMultibindProducer) <strong>initialize</strong>(injector, binding, scope, options) </a>
    

    
  </span>
  
  
    <span class="note title constructor">constructor</span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>A new instance of ArrayMultibindProducer.</p>
</div></span>
  
</li>

      
        
<li class="protected ">
  <span class="summary_signature">
    
      <a href="#internal_produce-instance_method" title="#internal_produce (instance method)">- (Object) <strong>internal_produce</strong>(scope) </a>
    

    
  </span>
  
  
  
  
  <span class="note title protected">protected</span>
  
  
  <span class="private note title">private</span>

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
    </ul>
  


  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods inherited from <span class='object_link'><a href="MultibindProducer.html" title="Puppet::Pops::Binder::Producers::MultibindProducer (class)">MultibindProducer</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="MultibindProducer.html#type_error_detail-instance_method" title="Puppet::Pops::Binder::Producers::MultibindProducer#type_error_detail (method)">#type_error_detail</a></span></p>

  
  
  
  
  
  
  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods inherited from <span class='object_link'><a href="Producer.html" title="Puppet::Pops::Binder::Producers::Producer (class)">Producer</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="Producer.html#do_transformation-instance_method" title="Puppet::Pops::Binder::Producers::Producer#do_transformation (method)">#do_transformation</a></span>, <span class='object_link'><a href="Producer.html#produce-instance_method" title="Puppet::Pops::Binder::Producers::Producer#produce (method)">#produce</a></span>, <span class='object_link'><a href="Producer.html#producer-instance_method" title="Puppet::Pops::Binder::Producers::Producer#producer (method)">#producer</a></span></p>
<div id="constructor_details" class="method_details_list">
  <h2>Constructor Details</h2>
  
    <div class="method_details first">
  <h3 class="signature first" id="initialize-instance_method">
  
    - (<tt><span class='object_link'><a href="" title="Puppet::Pops::Binder::Producers::ArrayMultibindProducer (class)">ArrayMultibindProducer</a></span></tt>) <strong>initialize</strong>(injector, binding, scope, options) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Returns a new instance of ArrayMultibindProducer</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>injector</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../Injector.html" title="Puppet::Pops::Binder::Injector (class)">Puppet::Pops::Binder::Injector</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>The injector where the lookup originates</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>binding</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../Bindings/Binding.html" title="Puppet::Pops::Binder::Bindings::Binding (class)">Puppet::Pops::Binder::Bindings::Binding</a></span></tt>, <tt>nil</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>The binding using this producer</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>scope</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../../../Parser/Scope.html" title="Puppet::Parser::Scope (class)">Puppet::Parser::Scope</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>The scope to use for evaluation</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>options</span>
      
      
        <span class='type'>(<tt><span class='object_link'>Hash</span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>a customizable set of options</p>
</div>
      
    </li>
  
</ul>

  
    
    
    
    
    
    
    
    
    <p class="tag_title">Options Hash (<tt>options</tt>):</p>
    <ul class="option">
      
        <li>
          <span class="name">:transformer</span>
          <span class="type">(<tt><span class='object_link'>Puppet::Pops::Model::LambdaExpression</span></tt>)</span>
          <span class="default">
            
              &mdash; default:
              <tt>nil</tt>
            
          </span>
          
            &mdash; <div class='inline'><p>a transformer of produced value</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:uniq</span>
          <span class="type">(<tt>Boolean</tt>)</span>
          <span class="default">
            
              &mdash; default:
              <tt>false</tt>
            
          </span>
          
            &mdash; <div class='inline'><p>if collected result should be post-processed to contain only unique entries</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:flatten</span>
          <span class="type">(<tt>Boolean</tt>, <tt>Integer</tt>)</span>
          <span class="default">
            
              &mdash; default:
              <tt>false</tt>
            
          </span>
          
            &mdash; <div class='inline'><p>if collected result should be post-processed so all contained arrays
are flattened. May be set to an Integer value to indicate the level of recursion (-1 is endless, 0 is none).</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:priority_on_named</span>
          <span class="type">(<tt>Boolean</tt>)</span>
          <span class="default">
            
              &mdash; default:
              <tt>true</tt>
            
          </span>
          
            &mdash; <div class='inline'><p>if highest precedented named element should win or if all should be included</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:priority_on_unnamed</span>
          <span class="type">(<tt>Boolean</tt>)</span>
          <span class="default">
            
              &mdash; default:
              <tt>false</tt>
            
          </span>
          
            &mdash; <div class='inline'><p>if highest precedented unnamed element should win or if all should be included</p>
</div>
          
        </li>
      
    </ul>
  


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


592
593
594
595
596
597
598
599
600
601
602
603
604
605
606
607
608
609
610</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/puppet/pops/binder/producers.rb', line 592</span>

<span class='kw'>def</span> <span class='id identifier rubyid_initialize'>initialize</span><span class='lparen'>(</span><span class='id identifier rubyid_injector'>injector</span><span class='comma'>,</span> <span class='id identifier rubyid_binding'>binding</span><span class='comma'>,</span> <span class='id identifier rubyid_scope'>scope</span><span class='comma'>,</span> <span class='id identifier rubyid_options'>options</span><span class='rparen'>)</span>
  <span class='kw'>super</span>
  <span class='ivar'>@uniq</span> <span class='op'>=</span> <span class='op'>!</span><span class='op'>!</span><span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:uniq</span><span class='rbracket'>]</span>
  <span class='ivar'>@flatten</span> <span class='op'>=</span> <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:flatten</span><span class='rbracket'>]</span>
  <span class='ivar'>@priority_on_named</span> <span class='op'>=</span> <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:priority_on_named</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span> <span class='op'>?</span> <span class='kw'>true</span> <span class='op'>:</span> <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:priority_on_name</span><span class='rbracket'>]</span>
  <span class='ivar'>@priority_on_unnamed</span> <span class='op'>=</span> <span class='op'>!</span><span class='op'>!</span><span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:priority_on_unnamed</span><span class='rbracket'>]</span>

  <span class='kw'>case</span> <span class='ivar'>@flatten</span>
  <span class='kw'>when</span> <span class='const'>Integer</span>
  <span class='kw'>when</span> <span class='kw'>true</span>
    <span class='ivar'>@flatten</span> <span class='op'>=</span> <span class='op'>-</span><span class='int'>1</span>
  <span class='kw'>when</span> <span class='kw'>false</span>
    <span class='ivar'>@flatten</span> <span class='op'>=</span> <span class='kw'>nil</span>
  <span class='kw'>when</span> <span class='const'>NilClass</span>
    <span class='ivar'>@flatten</span> <span class='op'>=</span> <span class='kw'>nil</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'>ArgumentError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Option :flatten must be nil, Boolean, or an integer value</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>unless</span> <span class='ivar'>@flatten</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span><span class='lparen'>(</span><span class='const'>Integer</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
  
</div>

  <div id="instance_attr_details" class="attr_details">
    <h2>Instance Attribute Details</h2>
    
      
      <span id=""></span>
      <div class="method_details first">
  <h3 class="signature first" id="flatten-instance_method">
  
    - (<tt>Boolean</tt>, <tt>Integer</tt>) <strong>flatten</strong>  <span class="extras">(readonly)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Returns If result should be flattened (true), or not (false), or flattened to given level (0 = none, -1 = all)</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>, <tt>Integer</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>If result should be flattened (true), or not (false), or flattened to given level (0 = none, -1 = all)</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


571
572
573</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/puppet/pops/binder/producers.rb', line 571</span>

<span class='kw'>def</span> <span class='id identifier rubyid_flatten'>flatten</span>
  <span class='ivar'>@flatten</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id=""></span>
      <div class="method_details ">
  <h3 class="signature " id="priority_on_named-instance_method">
  
    - (<tt>Boolean</tt>) <strong>priority_on_named</strong>  <span class="extras">(readonly)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Returns whether priority should be considered for named contributions</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>whether priority should be considered for named contributions</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


575
576
577</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/puppet/pops/binder/producers.rb', line 575</span>

<span class='kw'>def</span> <span class='id identifier rubyid_priority_on_named'>priority_on_named</span>
  <span class='ivar'>@priority_on_named</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id=""></span>
      <div class="method_details ">
  <h3 class="signature " id="priority_on_unnamed-instance_method">
  
    - (<tt>Boolean</tt>) <strong>priority_on_unnamed</strong>  <span class="extras">(readonly)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Returns whether priority should be considered for unnamed contributions</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>whether priority should be considered for unnamed contributions</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


579
580
581</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/puppet/pops/binder/producers.rb', line 579</span>

<span class='kw'>def</span> <span class='id identifier rubyid_priority_on_unnamed'>priority_on_unnamed</span>
  <span class='ivar'>@priority_on_unnamed</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id=""></span>
      <div class="method_details ">
  <h3 class="signature " id="uniq-instance_method">
  
    - (<tt>Boolean</tt>) <strong>uniq</strong>  <span class="extras">(readonly)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Returns whether the result should be made contain unique (non-equal) entries or not</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>whether the result should be made contain unique (non-equal) entries or not</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


567
568
569</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/puppet/pops/binder/producers.rb', line 567</span>

<span class='kw'>def</span> <span class='id identifier rubyid_uniq'>uniq</span>
  <span class='ivar'>@uniq</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>


  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="assert_type-instance_method">
  
    - (<tt><span class='object_link'>Object</span></tt>) <strong>assert_type</strong>(binding, tc, value)  <span class="extras">(protected)</span>&nbsp;<span class="note title protected">protected</span><span class="private note title">private</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p class="note private">
  <strong>This method is part of a private API.</strong>
  You should avoid using this method if possible, as it may be removed or be changed in the future.
</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


655
656
657
658
659
660
661</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/puppet/pops/binder/producers.rb', line 655</span>

<span class='kw'>def</span> <span class='id identifier rubyid_assert_type'>assert_type</span><span class='lparen'>(</span><span class='id identifier rubyid_binding'>binding</span><span class='comma'>,</span> <span class='id identifier rubyid_tc'>tc</span><span class='comma'>,</span> <span class='id identifier rubyid_value'>value</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_infered'>infered</span> <span class='op'>=</span> <span class='id identifier rubyid_tc'>tc</span><span class='period'>.</span><span class='id identifier rubyid_infer'>infer</span><span class='lparen'>(</span><span class='id identifier rubyid_value'>value</span><span class='rparen'>)</span>
  <span class='kw'>unless</span> <span class='id identifier rubyid_tc'>tc</span><span class='period'>.</span><span class='id identifier rubyid_assignable?'>assignable?</span><span class='lparen'>(</span><span class='id identifier rubyid_binding'>binding</span><span class='period'>.</span><span class='id identifier rubyid_type'>type</span><span class='period'>.</span><span class='id identifier rubyid_element_type'>element_type</span><span class='comma'>,</span> <span class='id identifier rubyid_infered'>infered</span><span class='rparen'>)</span> <span class='op'>||</span> <span class='id identifier rubyid_tc'>tc</span><span class='period'>.</span><span class='id identifier rubyid_assignable?'>assignable?</span><span class='lparen'>(</span><span class='id identifier rubyid_binding'>binding</span><span class='period'>.</span><span class='id identifier rubyid_type'>type</span><span class='comma'>,</span> <span class='id identifier rubyid_infered'>infered</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'>ArgumentError</span><span class='comma'>,</span> <span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Type Error: contribution to &#39;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_binding'>binding</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span><span class='embexpr_end'>}</span><span class='tstring_content'>&#39; does not match type of multibind, </span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
      <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_type_error_detail'>type_error_detail</span><span class='lparen'>(</span><span class='lbracket'>[</span><span class='id identifier rubyid_binding'>binding</span><span class='period'>.</span><span class='id identifier rubyid_type'>type</span><span class='period'>.</span><span class='id identifier rubyid_element_type'>element_type</span><span class='comma'>,</span> <span class='id identifier rubyid_binding'>binding</span><span class='period'>.</span><span class='id identifier rubyid_type'>type</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='id identifier rubyid_value'>value</span><span class='rparen'>)</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="internal_produce-instance_method">
  
    - (<tt><span class='object_link'>Object</span></tt>) <strong>internal_produce</strong>(scope)  <span class="extras">(protected)</span>&nbsp;<span class="note title protected">protected</span><span class="private note title">private</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p class="note private">
  <strong>This method is part of a private API.</strong>
  You should avoid using this method if possible, as it may be removed or be changed in the future.
</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


615
616
617
618
619
620
621
622
623
624
625
626
627
628
629
630
631
632
633
634
635
636
637
638
639
640
641
642
643
644
645
646
647
648
649
650
651
652</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/puppet/pops/binder/producers.rb', line 615</span>

<span class='kw'>def</span> <span class='id identifier rubyid_internal_produce'>internal_produce</span><span class='lparen'>(</span><span class='id identifier rubyid_scope'>scope</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_seen'>seen</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>
  <span class='id identifier rubyid_included_keys'>included_keys</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>

  <span class='id identifier rubyid_injector'>injector</span><span class='period'>.</span><span class='id identifier rubyid_get_contributions'>get_contributions</span><span class='lparen'>(</span><span class='id identifier rubyid_scope'>scope</span><span class='comma'>,</span> <span class='id identifier rubyid_contributions_key'>contributions_key</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_element'>element</span><span class='op'>|</span>
    <span class='id identifier rubyid_key'>key</span> <span class='op'>=</span> <span class='id identifier rubyid_element'>element</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_entry'>entry</span> <span class='op'>=</span> <span class='id identifier rubyid_element'>element</span><span class='lbracket'>[</span><span class='int'>1</span><span class='rbracket'>]</span>

    <span class='id identifier rubyid_name'>name</span> <span class='op'>=</span> <span class='id identifier rubyid_entry'>entry</span><span class='period'>.</span><span class='id identifier rubyid_binding'>binding</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span>
    <span class='id identifier rubyid_existing'>existing</span> <span class='op'>=</span> <span class='id identifier rubyid_seen'>seen</span><span class='lbracket'>[</span><span class='id identifier rubyid_name'>name</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_empty_name'>empty_name</span> <span class='op'>=</span> <span class='id identifier rubyid_name'>name</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span> <span class='op'>||</span> <span class='id identifier rubyid_name'>name</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_existing'>existing</span>
      <span class='kw'>if</span> <span class='id identifier rubyid_empty_name'>empty_name</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_priority_on_unnamed'>priority_on_unnamed</span>
        <span class='kw'>if</span> <span class='lparen'>(</span><span class='id identifier rubyid_seen'>seen</span><span class='lbracket'>[</span><span class='id identifier rubyid_name'>name</span><span class='rbracket'>]</span> <span class='op'>&lt;=&gt;</span> <span class='id identifier rubyid_entry'>entry</span><span class='rparen'>)</span> <span class='op'>&gt;=</span> <span class='int'>0</span>
          <span class='id identifier rubyid_raise'>raise</span> <span class='const'>ArgumentError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Duplicate key (same priority) contributed to Array Multibinding &#39;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_binding'>binding</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span><span class='embexpr_end'>}</span><span class='tstring_content'>&#39; with unnamed entry.</span><span class='tstring_end'>&quot;</span></span>
        <span class='kw'>end</span>
        <span class='kw'>next</span>
      <span class='kw'>elsif</span> <span class='op'>!</span><span class='id identifier rubyid_empty_name'>empty_name</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_priority_on_named'>priority_on_named</span>
        <span class='kw'>if</span> <span class='lparen'>(</span><span class='id identifier rubyid_seen'>seen</span><span class='lbracket'>[</span><span class='id identifier rubyid_name'>name</span><span class='rbracket'>]</span> <span class='op'>&lt;=&gt;</span> <span class='id identifier rubyid_entry'>entry</span><span class='rparen'>)</span> <span class='op'>&gt;=</span> <span class='int'>0</span>
          <span class='id identifier rubyid_raise'>raise</span> <span class='const'>ArgumentError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Duplicate key (same priority) contributed to Array Multibinding &#39;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_binding'>binding</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span><span class='embexpr_end'>}</span><span class='tstring_content'>&#39;, key: &#39;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_name'>name</span><span class='embexpr_end'>}</span><span class='tstring_content'>&#39;.</span><span class='tstring_end'>&quot;</span></span>
        <span class='kw'>end</span>
        <span class='kw'>next</span>
      <span class='kw'>end</span>
    <span class='kw'>else</span>
      <span class='id identifier rubyid_seen'>seen</span><span class='lbracket'>[</span><span class='id identifier rubyid_name'>name</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_entry'>entry</span>
    <span class='kw'>end</span>
    <span class='id identifier rubyid_included_keys'>included_keys</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_key'>key</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_result'>result</span> <span class='op'>=</span> <span class='id identifier rubyid_included_keys'>included_keys</span><span class='period'>.</span><span class='id identifier rubyid_collect'>collect</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_k'>k</span><span class='op'>|</span>
    <span class='id identifier rubyid_x'>x</span> <span class='op'>=</span> <span class='id identifier rubyid_injector'>injector</span><span class='period'>.</span><span class='id identifier rubyid_lookup_key'>lookup_key</span><span class='lparen'>(</span><span class='id identifier rubyid_scope'>scope</span><span class='comma'>,</span> <span class='id identifier rubyid_k'>k</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_assert_type'>assert_type</span><span class='lparen'>(</span><span class='id identifier rubyid_binding'>binding</span><span class='lparen'>(</span><span class='rparen'>)</span><span class='comma'>,</span> <span class='id identifier rubyid_injector'>injector</span><span class='period'>.</span><span class='id identifier rubyid_type_calculator'>type_calculator</span><span class='lparen'>(</span><span class='rparen'>)</span><span class='comma'>,</span> <span class='id identifier rubyid_x'>x</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_x'>x</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_result'>result</span><span class='period'>.</span><span class='id identifier rubyid_flatten!'>flatten!</span><span class='lparen'>(</span><span class='id identifier rubyid_flatten'>flatten</span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='id identifier rubyid_flatten'>flatten</span>
  <span class='id identifier rubyid_result'>result</span><span class='period'>.</span><span class='id identifier rubyid_uniq!'>uniq!</span> <span class='kw'>if</span> <span class='id identifier rubyid_uniq'>uniq</span>
  <span class='id identifier rubyid_result'>result</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

    <div id="footer">
  Generated on Thu Jan 14 14:51:44 2016 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.8.7.6 (ruby-2.0.0).
</div>

  </body>
</html>